# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Cloudflare Bot Requests
description: |-
  Detect bots making HTTP requests at a high volume, which
  may indicate automated attacks or scraping activities.

  This rule uses the Cloudflare Bot Score, which is a score
  from 1 to 99 that indiciates how likely the request came
  came from a bot. Scores of 1 through 29 are likely
  automated requests.

  The default threshold is 600 requests per 5 minutes (2 RPS).
enabled: true
severity: Low
query_text: |-
  %ingest.source_type:"cloudflare:http"
  BotScore < 30 and BotScore > 0
  | groupbycount(ClientIP)
  | where @q.count > 600
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- low_severity_alerts
tags:
- tactics.ta0040.impact
- techniques.t1499.endpoint_denial_of_service
- source.cloudflare
